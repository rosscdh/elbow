{% extends 'order/base.html' %}{% load i18n static crispy_forms_tags djmoney embed_video_tags project_tags %}
{% load crispy_forms_filters %}

{% block page_title %}{% blocktrans with project=project.name %}{{ project }} - Invest Now{% endblocktrans %}{% endblock %}
{% block page_description %}{% blocktrans with project=project.name %}Invest in {{ project }}{% endblocktrans %}{% endblock %}
{% block page_keywords %}invest,project,and-development,development{% endblock %}

{% block page_header %}
<div class="page-header clearfix">
  <h1>{% blocktrans with project=project.name %}Invest in {{ project }}{% endblocktrans %}</h1>
  <p>{{ project.proposition }}</p>
</div>
<div class="clearfix"></div>
{% endblock %}

{% block content %}
<div class="row">

  <div class="col-sm-5">

    <div class="col-md-12" style="margin-bottom:20px;padding:0px;">
      <img src="{% get_media_prefix %}{{ project.image }}" class="img img-responsive" alt="" title="" />
    </div>

    <div class="col-sm-12" style="padding:0px;">
      <div class="col-sm-4 well well-sm text-center">
        {% trans "Backers" %}<br/><span class="badge">{{ project.num_backers }}</span>
      </div>
      <div class="col-sm-4 well well-sm text-center">
        {% trans "Revenue" %}<br/><span class="badge">{% money_localize project.revenue %}</span>
      </div>
    </div>

    <div class="col-sm-12" style="padding:0px;">
      {% project_docs project %}
      </ul>
    </div>

  </div>

  <div class="col-sm-7">
    <!-- <p>{{ project.description }}</p> -->
    {% crispy form %}
  </div>

</div>
{% endblock %}

{% block css %}
  {{ block.super }}
  <style>
  #accrue-target div.form {
    display:none;
  }
  .selectdatewidget {
    width:25%;
    display:inline-flex;
  }
  .buttonHolder {
    text-align:center;
  }
  </style>
{% endblock %}

{% block javascript %}
  {{ block.super }}

  <script type="text/javascript">
  $( document ).ready(function() {
      'use strict';

      //
      // Interest calculator
      //
      var interest_rate_pa = '{{ project.interest_rate }}'.replace(',', '.');
      $('#interest_rate_pa').html(interest_rate_pa+'%');
      var display_interest_term = '{{ project.interest_term }}'.replace('m', ' {% trans "Months" %}')
      display_interest_term = display_interest_term.replace('y', ' {% trans "Years" %}')
      $('#interest_term').html(display_interest_term);

      $( '#accrue-target' ).accrue({
        mode: "basic",
        operation: "keyup",
        default_values: {
          amount: "0",
          rate: "{{ project.interest_rate }}%".replace(',', '.'),
          rate_compare: "1.49%",
          term: "{{ project.interest_term }}",
        },
        response_basic:
          '<p><strong>Total Interest:</strong>&nbsp;â‚¬%total_interest%</p>',
        response_compare: "Save $%savings% in interest!",
        error_text: null,
        target_fields: {
          amount: $('#id_amount')
        }
      });

      //
      // Amount checker
      //
      $('#id_amount').on('change keyup', function (event) {
        var amount = parseInt($(this).val());
        console.log(amount)
        if (amount >= 1000) {
          // if the user wants more than 1k invested he needs a darllensvertrag
          $('#loan-contract').removeClass('hide').fadeIn();
        } else {
          $('#loan-contract').addClass('hide');
        }
      });
  });
  </script>
{% endblock %}
interest_rate_pa
interest_rate_total